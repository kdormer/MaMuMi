extends base-template

block content
  h1= title
  p Choose a date, see journeys!

  #datePick
    input(type="date", id="datePicker", name="date", value= new Date().toISOString().split("T")[0])

  #gMap(style="width:100%;height:800px;")

  #testOut

  

  script.
    
    var map, markers;

    async function myMap() {
      var mapProp= {
        center:new google.maps.LatLng(51.508742,-0.120850),
        zoom:5,
      };

      map = new google.maps.Map(document.getElementById("gMap"),mapProp);
    }

    async function updateMap() {
      date = $('#datePicker').val();

      map.data.forEach( function (feature) {
        map.data.remove(feature);
      })

      map.data.loadGeoJson("http://raspberrypi.lan:3000/events/" + date);
      map.data.setStyle({
        icon: 'http://raspberrypi.lan:3000/s/img/cat_icon.svg'
      })
    }

    $(document).ready( function () {
      myMap();
      updateMap();
    })

    $('#datePicker').change(updateMap);

  script(src="https://maps.googleapis.com/maps/api/js")